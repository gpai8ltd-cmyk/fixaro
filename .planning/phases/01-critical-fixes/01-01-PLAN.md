---
phase: 01-critical-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - tools-shop/src/app/api/products/route.ts
  - tools-shop/src/components/Footer.tsx
  - tools-shop/src/app/(shop)/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can search for products and receive relevant results"
    - "Footer displays clean branding without security badges"
    - "Footer displays clean branding without courier logos"
    - "Hero section shows core messaging without placeholder rating"
  artifacts:
    - path: "tools-shop/src/app/api/products/route.ts"
      provides: "Working search query with SQLite-compatible case-insensitive matching"
      contains: "LOWER"
    - path: "tools-shop/src/components/Footer.tsx"
      provides: "Clean footer without security badges or courier logos"
    - path: "tools-shop/src/app/(shop)/page.tsx"
      provides: "Hero section without 4.9/5 rating badge"
  key_links:
    - from: "tools-shop/src/components/Header.tsx"
      to: "/api/products?q="
      via: "search form submission"
      pattern: "action=\"/products\""
---

<objective>
Fix product search and remove placeholder UI elements from footer and hero section.

Purpose: Establish a professional, trustworthy appearance by fixing broken search and removing unverified badges.
Output: Working search API and clean homepage without placeholder elements.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@tools-shop/src/app/api/products/route.ts
@tools-shop/src/components/Footer.tsx
@tools-shop/src/app/(shop)/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix product search API for SQLite</name>
  <files>tools-shop/src/app/api/products/route.ts</files>
  <action>
The search functionality uses Prisma's `mode: 'insensitive'` which is NOT supported by SQLite (the project uses SQLite as seen in dev.db).

Fix the search by using raw SQL with LOWER() function for case-insensitive matching:

1. Replace the current search block (lines 29-35) with SQLite-compatible approach
2. Use Prisma's raw query or modify the where clause to use LOWER() comparisons
3. For Prisma with SQLite, use: `{ nameBg: { contains: search } }` without mode (SQLite contains is case-insensitive by default for ASCII, but Bulgarian characters need LOWER)
4. Alternative: Use $queryRaw with LOWER() for proper Bulgarian case-insensitive search

Recommended approach - use simple contains without mode (remove `mode: 'insensitive'`):
```typescript
if (search && search.trim()) {
  const searchLower = search.toLowerCase();
  where.OR = [
    { nameBg: { contains: searchLower } },
    { nameEn: { contains: searchLower } },
    { descriptionBg: { contains: searchLower } },
  ];
}
```

Note: SQLite's LIKE is case-insensitive for ASCII but case-sensitive for Unicode. For Bulgarian text, the search will work for exact case matches. This is acceptable for v1.
  </action>
  <verify>
1. Start dev server: `cd tools-shop && npm run dev`
2. Test search: `curl "http://localhost:3000/api/products?q=test"` returns 200 with JSON array
3. Search with Bulgarian text should not error
  </verify>
  <done>
Search API returns results without error. Products matching the query are returned.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove security badges and courier logos from footer</name>
  <files>tools-shop/src/components/Footer.tsx</files>
  <action>
Remove two sections from Footer.tsx:

1. Remove the entire "Security badges" section (lines 212-254):
   - The div with classes "border-t border-slate-700" containing SSL, Verified store, 14-day return, and Data protection badges
   - Remove these unused imports: Lock, BadgeCheck, RotateCcw (keep Shield - it's used in trust badges section)

2. Remove the courier logos from bottom bar (lines 262-265):
   - Remove the div containing econt.png and speedy.png images
   - Keep the copyright text

The bottom bar should only contain:
- Copyright text on the left
- Nothing on the right (remove the flex container with images)

Final bottom bar structure:
```tsx
<div className="border-t border-slate-700">
  <div className="container-custom py-4">
    <p className="text-slate-500 text-sm text-center sm:text-left">
      &copy; {new Date().getFullYear()} ToolsShop. Всички права запазени.
    </p>
  </div>
</div>
```
  </action>
  <verify>
1. Footer renders without errors
2. No security badges visible (SSL, Verified, 14-day, Data protection)
3. No courier logos visible (Econt, Speedy)
4. Copyright text still displays
5. Trust badges section (free delivery, warranty, COD, original products) remains intact
  </verify>
  <done>
Footer shows only trust badges (delivery, warranty, COD, original products), contact info, and copyright. No security badges or courier logos visible.
  </done>
</task>

<task type="auto">
  <name>Task 3: Remove rating from hero section</name>
  <files>tools-shop/src/app/(shop)/page.tsx</files>
  <action>
Remove the "4.9/5 от 500+ отзива" rating display from the hero section.

In the hero section, locate the trust badges div (around line 150-163):
```tsx
<div className="mt-10 flex flex-wrap items-center gap-6 text-slate-400 text-sm">
  <div className="flex items-center gap-2">
    <div className="flex -space-x-1">
      {[1,2,3,4,5].map(i => (
        <Star key={i} size={16} className="text-yellow-400 fill-yellow-400" />
      ))}
    </div>
    <span>4.9/5 от 500+ отзива</span>
  </div>
  <div className="flex items-center gap-2">
    <Shield size={18} className="text-green-400" />
    <span>2 години гаранция</span>
  </div>
</div>
```

Remove the first child div (rating with stars), keeping only the warranty badge:
```tsx
<div className="mt-10 flex flex-wrap items-center gap-6 text-slate-400 text-sm">
  <div className="flex items-center gap-2">
    <Shield size={18} className="text-green-400" />
    <span>2 години гаранция</span>
  </div>
</div>
```

Also remove the Star import from lucide-react if no longer used elsewhere in the file.
  </action>
  <verify>
1. Homepage renders without errors
2. Hero section shows warranty badge only
3. No star rating visible
4. No console errors about unused imports
  </verify>
  <done>
Hero section displays warranty badge without the 4.9/5 rating. Clean messaging without placeholder metrics.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `cd tools-shop && npm run build` - Build succeeds without errors
2. `npm run dev` - Dev server starts
3. Visit http://localhost:3000 - Homepage loads with clean hero (no rating)
4. Scroll to footer - Only trust badges visible, no security badges or courier logos
5. Use search in header - Results page shows matching products
</verification>

<success_criteria>
- FIX-01: Search API returns products matching query without errors
- FIX-02: Security badges removed from footer
- FIX-03: Courier logos removed from footer
- FIX-04: Rating badge removed from hero section
</success_criteria>

<output>
After completion, create `.planning/phases/01-critical-fixes/01-01-SUMMARY.md`
</output>
